<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorator="template">
<head>
<title>Zumma | Usuarios</title>
</head>
<body>
	<div layout:fragment="header">
		<div th:replace="fragments/header :: header"></div>
	</div>
	<div layout:fragment="content">
		<ol class="breadcrumb">
			<li><a href="#">Administración</a></li>
			<li class="active">Usuarios</li>
		</ol>
		<div class="panel panel-default">
		  <div class="panel-heading">
		  	<h1>Usuarios <small>Listado de cuentas de usuario</small>
	   	        <form class="navbar-form navbar-right">
		            <a href="/user/create" class="btn btn-primary">Nuevo</a>
			        <input type="text" class="form-control" placeholder="Search"/>
	            </form>
            </h1>
		  </div>
		  <div class="panel-body" style="padding: 10px;">
		    <table class="table table-hover table-condensed">
			    <thead>
			    <tr>
			    	<th>#</th>
			        <th>E-mail</th>
			        <th>Role</th>
			        <th>View</th>
			        <th>Edit</th>
			        <th>Delete</th>
			    </tr>
			    </thead>
			    <tbody>
			        <tr th:if="${users.empty}">
			            <td colspan="4">No users</td>
			        </tr>
			        <tr th:each="user : ${users}">
			       		<td th:text="${user.id}">NotFound</td>
			            <td th:text="${user.email}">NotFound</td>
			            <td th:text="${user.role}">NotFound</td>
			            <td><a href="" th:attr="data-id=${user.getId()}" data-toggle="modal" data-target="#viewUserModal" class="viewButton"><span class="glyphicon glyphicon-check" aria-hidden="true"></span></a></td>
			            <td><a th:attr="href='/user/' + ${user.getId()} + '/edit'"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></a></td>
			            <td><a href="" th:attr="data-id=${user.getId()}" class="deleteButton"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a></td>
			        </tr>
			    </tbody>
			</table>
		  </div>
		  <div class="panel-footer" align="right">
			<nav aria-label="Page navigation">
			  <ul class="pagination">
			    <li>
			      <a href="#" aria-label="Previous" class="btn btn-xs">
			        <span aria-hidden="true">&laquo;</span>
			      </a>
			    </li>
			    <li><a href="#" class="btn btn-xs">1</a></li>
			    <li><a href="#" class="btn btn-xs">2</a></li>
			    <li><a href="#" class="btn btn-xs">3</a></li>
			    <li><a href="#" class="btn btn-xs">4</a></li>
			    <li><a href="#" class="btn btn-xs">5</a></li>
			    <li>
			      <a href="#" aria-label="Next" class="btn btn-xs">
			        <span aria-hidden="true">&raquo;</span>
			      </a>
			    </li>
			  </ul>
			</nav>
		  </div>
		</div>
		<script type="text/javascript">
		$(document).ready(function() {
			$('.viewButton').on('click', function() {
		        var id = $(this).attr('data-id');
		        $.ajax({
		            url: '/user/' + id,
		            method: 'GET'
		        }).success(function(response) {
		            $("#modal_body").html( response );
		        });
			});
			$('.deleteButton').on('click', function() {
		        var id = $(this).attr('data-id');
		        var result = confirm("Está seguro de eliminar este usuario?");
		        if(result){
		        	$.ajax({
			            url: '/user/' + id,
			            method: 'DELETE'
			        });
		        }
			});
		});
		</script>
		<!-- Modal View -->
		<div class="modal fade" id="viewUserModal" tabindex="-1" role="dialog">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title">Vista de usuario</h4>
		      </div>
		      <div class="modal-body" id="modal_body">
				<!-- dynamic content here -->
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
		      </div>
		    </div><!-- /.modal-content -->
		  </div><!-- /.modal-dialog -->
		</div><!-- /.modal -->
	</div>
	<div layout:fragment="footer">
		<div th:replace="fragments/footer :: footer"></div>
	</div>
</body>
</html>
